import{s as e,r as t,u as i,j as s,D as n,B as r,F as o,a,T as c,b as l,S as u,C as p,L as d,E as h,d as m,e as g,f as y,g as v,M as f,h as k,i as x,k as S}from"./three-DXZHVDzQ.js";import{c as w}from"./state-BkeyMcK-.js";import{m as M}from"./ui-CUR-1bmS.js";import"./vendor-DOHx2j1n.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const i of e)if("childList"===i.type)for(const e of i.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();class b{canvas;state;previousState;callbacks=new Map;constructor(e){this.canvas=e,this.state={keys:new Set,mouse:{x:0,y:0,buttons:new Set,wheel:0},touch:{touches:[],isActive:!1}},this.previousState=this.cloneState(this.state),this.setupEventListeners()}cloneState(e){return{keys:new Set(e.keys),mouse:{x:e.mouse.x,y:e.mouse.y,buttons:new Set(e.mouse.buttons),wheel:e.mouse.wheel},touch:{touches:[...e.touch.touches],isActive:e.touch.isActive}}}setupEventListeners(){window.addEventListener("keydown",this.handleKeyDown.bind(this)),window.addEventListener("keyup",this.handleKeyUp.bind(this)),this.canvas.addEventListener("mousedown",this.handleMouseDown.bind(this)),this.canvas.addEventListener("mouseup",this.handleMouseUp.bind(this)),this.canvas.addEventListener("mousemove",this.handleMouseMove.bind(this)),this.canvas.addEventListener("wheel",this.handleWheel.bind(this)),this.canvas.addEventListener("touchstart",this.handleTouchStart.bind(this),{passive:!1}),this.canvas.addEventListener("touchend",this.handleTouchEnd.bind(this),{passive:!1}),this.canvas.addEventListener("touchmove",this.handleTouchMove.bind(this),{passive:!1}),this.canvas.addEventListener("contextmenu",e=>e.preventDefault()),this.canvas.tabIndex=0}handleKeyDown(e){this.state.keys.add(e.code),this.triggerCallback("keydown",e);["Space","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","KeyW","KeyA","KeyS","KeyD"].includes(e.code)&&e.preventDefault()}handleKeyUp(e){this.state.keys.delete(e.code),this.triggerCallback("keyup",e)}handleMouseDown(e){this.state.mouse.buttons.add(e.button),this.updateMousePosition(e),this.triggerCallback("mousedown",e),this.canvas.focus()}handleMouseUp(e){this.state.mouse.buttons.delete(e.button),this.updateMousePosition(e),this.triggerCallback("mouseup",e)}handleMouseMove(e){this.updateMousePosition(e),this.triggerCallback("mousemove",e)}handleWheel(e){this.state.mouse.wheel=e.deltaY,this.triggerCallback("wheel",e),e.preventDefault()}updateMousePosition(e){const t=this.canvas.getBoundingClientRect();this.state.mouse.x=e.clientX-t.left,this.state.mouse.y=e.clientY-t.top}handleTouchStart(e){this.state.touch.isActive=!0,this.state.touch.touches=Array.from(e.touches),this.triggerCallback("touchstart",e),e.preventDefault()}handleTouchEnd(e){this.state.touch.touches=Array.from(e.touches),0===e.touches.length&&(this.state.touch.isActive=!1),this.triggerCallback("touchend",e),e.preventDefault()}handleTouchMove(e){this.state.touch.touches=Array.from(e.touches),this.triggerCallback("touchmove",e),e.preventDefault()}isKeyPressed(e){return this.state.keys.has(e)}isKeyJustPressed(e){return this.state.keys.has(e)&&!this.previousState.keys.has(e)}isKeyJustReleased(e){return!this.state.keys.has(e)&&this.previousState.keys.has(e)}isMouseButtonPressed(e){return this.state.mouse.buttons.has(e)}isMouseButtonJustPressed(e){return this.state.mouse.buttons.has(e)&&!this.previousState.mouse.buttons.has(e)}isMouseButtonJustReleased(e){return!this.state.mouse.buttons.has(e)&&this.previousState.mouse.buttons.has(e)}getMousePosition(){return{x:this.state.mouse.x,y:this.state.mouse.y}}getMouseWheel(){return this.state.mouse.wheel}getTouches(){return[...this.state.touch.touches]}isTouchActive(){return this.state.touch.isActive}on(e,t){this.callbacks.has(e)||this.callbacks.set(e,new Set),this.callbacks.get(e).add(t)}off(e,t){const i=this.callbacks.get(e);i&&i.delete(t)}triggerCallback(e,t){const i=this.callbacks.get(e);i&&i.forEach(e=>e(t))}update(){this.previousState=this.cloneState(this.state),this.state.mouse.wheel=0}getMovementInput(){let e=0,t=0;if((this.isKeyPressed("KeyW")||this.isKeyPressed("ArrowUp"))&&(t-=1),(this.isKeyPressed("KeyS")||this.isKeyPressed("ArrowDown"))&&(t+=1),(this.isKeyPressed("KeyA")||this.isKeyPressed("ArrowLeft"))&&(e-=1),(this.isKeyPressed("KeyD")||this.isKeyPressed("ArrowRight"))&&(e+=1),0!==e&&0!==t){const i=Math.sqrt(e*e+t*t);e/=i,t/=i}return{x:e,y:t}}getActionInputs(){return{interact:this.isKeyJustPressed("KeyE")||this.isKeyJustPressed("Space"),menu:this.isKeyJustPressed("Escape"),inventory:this.isKeyJustPressed("KeyI"),skills:this.isKeyJustPressed("KeyK"),confirm:this.isKeyJustPressed("Enter"),cancel:this.isKeyJustPressed("Escape")}}destroy(){window.removeEventListener("keydown",this.handleKeyDown.bind(this)),window.removeEventListener("keyup",this.handleKeyUp.bind(this)),this.canvas.removeEventListener("mousedown",this.handleMouseDown.bind(this)),this.canvas.removeEventListener("mouseup",this.handleMouseUp.bind(this)),this.canvas.removeEventListener("mousemove",this.handleMouseMove.bind(this)),this.canvas.removeEventListener("wheel",this.handleWheel.bind(this)),this.canvas.removeEventListener("touchstart",this.handleTouchStart.bind(this)),this.canvas.removeEventListener("touchend",this.handleTouchEnd.bind(this)),this.canvas.removeEventListener("touchmove",this.handleTouchMove.bind(this)),this.callbacks.clear()}}class j{audioSources=new Map;settings;audioContext=null;gainNodes=new Map;constructor(){this.settings={masterVolume:.7,musicVolume:.5,sfxVolume:.8,muted:!1},this.loadSettingsFromStorage(),this.initializeAudioContext()}initializeAudioContext(){try{this.audioContext=new(window.AudioContext||window.webkitAudioContext);const e=this.audioContext.createGain(),t=this.audioContext.createGain(),i=this.audioContext.createGain();e.connect(this.audioContext.destination),t.connect(e),i.connect(e),this.gainNodes.set("master",e),this.gainNodes.set("music",t),this.gainNodes.set("sfx",i),this.updateGainNodes()}catch(e){console.warn("Web Audio API not supported:",e)}}updateGainNodes(){if(!this.audioContext)return;const e=this.gainNodes.get("master"),t=this.gainNodes.get("music"),i=this.gainNodes.get("sfx");e&&(e.gain.value=this.settings.muted?0:this.settings.masterVolume),t&&(t.gain.value=this.settings.musicVolume),i&&(i.gain.value=this.settings.sfxVolume)}async loadAudio(e,t,i="sfx",s=!1){return new Promise((n,r)=>{const o=new Audio;o.addEventListener("canplaythrough",()=>{const t={audio:o,volume:1,loop:s,category:i};this.audioSources.set(e,t),n()}),o.addEventListener("error",t=>{console.error(`Failed to load audio: ${e}`,t),r(t)}),o.src=t,o.preload="auto"})}play(e,t=1,i=!1,s=1){const n=this.audioSources.get(e);if(!n)return void console.warn(`Audio not found: ${e}`);n.audio.pause(),n.audio.currentTime=0,n.volume=t,n.audio.loop=n.loop,i?(n.fadeIn=!0,n.fadeDuration=s,n.currentFade=0,n.audio.volume=0):n.audio.volume=this.calculateEffectiveVolume(n);const r=n.audio.play();void 0!==r&&r.catch(e=>{console.warn("Audio play failed:",e)})}stop(e,t=!1,i=1){const s=this.audioSources.get(e);s&&(t?(s.fadeOut=!0,s.fadeDuration=i,s.currentFade=0):(s.audio.pause(),s.audio.currentTime=0))}pause(e){const t=this.audioSources.get(e);t&&t.audio.pause()}resume(e){const t=this.audioSources.get(e);if(t&&t.audio.paused){const e=t.audio.play();void 0!==e&&e.catch(e=>{console.warn("Audio resume failed:",e)})}}isPlaying(e){const t=this.audioSources.get(e);return!!t&&(!t.audio.paused&&t.audio.currentTime>0)}setVolume(e,t){this.settings[e]=Math.max(0,Math.min(1,t)),this.updateGainNodes(),this.updateAllAudioVolumes(),this.saveSettingsToStorage()}getVolume(e){return this.settings[e]}toggleMute(){this.settings.muted=!this.settings.muted,this.updateGainNodes(),this.updateAllAudioVolumes(),this.saveSettingsToStorage()}isMuted(){return this.settings.muted}calculateEffectiveVolume(e){if(this.settings.muted)return 0;let t=1;switch(e.category){case"music":t=this.settings.musicVolume;break;case"sfx":t=this.settings.sfxVolume}return e.volume*t*this.settings.masterVolume}updateAllAudioVolumes(){this.audioSources.forEach(e=>{e.fadeIn||e.fadeOut||(e.audio.volume=this.calculateEffectiveVolume(e))})}update(){const e=1/60;this.audioSources.forEach((t,i)=>{if(t.fadeIn&&void 0!==t.currentFade&&t.fadeDuration){t.currentFade+=e;const i=Math.min(t.currentFade/t.fadeDuration,1);t.audio.volume=this.calculateEffectiveVolume(t)*i,i>=1&&(t.fadeIn=!1,t.currentFade=void 0)}if(t.fadeOut&&void 0!==t.currentFade&&t.fadeDuration){t.currentFade+=e;const i=Math.min(t.currentFade/t.fadeDuration,1);t.audio.volume=this.calculateEffectiveVolume(t)*(1-i),i>=1&&(t.audio.pause(),t.audio.currentTime=0,t.fadeOut=!1,t.currentFade=void 0)}})}async preloadGameAudio(){const e=[{key:"click",src:"/assets/audio/ui/click.mp3",category:"sfx"},{key:"success",src:"/assets/audio/ui/success.mp3",category:"sfx"},{key:"error",src:"/assets/audio/ui/error.mp3",category:"sfx"},{key:"levelUp",src:"/assets/audio/game/level-up.mp3",category:"sfx"},{key:"achievement",src:"/assets/audio/game/achievement.mp3",category:"sfx"},{key:"backgroundMusic",src:"/assets/audio/music/background.mp3",category:"music",loop:!0},{key:"menuMusic",src:"/assets/audio/music/menu.mp3",category:"music",loop:!0}].map(({key:e,src:t,category:i,loop:s})=>this.loadAudio(e,t,i,s).catch(t=>{console.warn(`Failed to preload audio: ${e}`,t)}));await Promise.all(e)}playClick(){this.play("click",.5)}playSuccess(){this.play("success",.7)}playError(){this.play("error",.6)}playLevelUp(){this.play("levelUp",.8)}playAchievement(){this.play("achievement",.9)}playBackgroundMusic(){this.play("backgroundMusic",.3,!0,2)}playMenuMusic(){this.play("menuMusic",.4,!0,1.5)}loadSettingsFromStorage(){const e=localStorage.getItem("audioSettings");if(e)try{const t=JSON.parse(e);this.settings={...this.settings,...t}}catch(t){console.warn("Failed to load audio settings from storage:",t)}}saveSettingsToStorage(){try{localStorage.setItem("audioSettings",JSON.stringify(this.settings))}catch(e){console.warn("Failed to save audio settings to storage:",e)}}destroy(){this.audioSources.forEach(e=>{e.audio.pause(),e.audio.src=""}),this.audioSources.clear(),this.audioContext&&this.audioContext.close(),this.gainNodes.clear()}}class C{stats;skills;equipment;position;inventory=new Map;achievements=new Set;unlockedContent=new Set;constructor(){this.stats={level:1,experience:0,experienceToNext:100,reputation:0,energy:100,maxEnergy:100,money:0},this.skills={technicalMapping:1,artisticVision:1,equipmentMastery:1,socialMedia:1,collaboration:1},this.equipment={projector:null,computer:"basic-laptop",controller:null,software:["basic-vj-software"],accessories:[]},this.position={x:0,y:0,scene:"home"}}getStats(){return{...this.stats}}addExperience(e){for(this.stats.experience+=e;this.stats.experience>=this.stats.experienceToNext;)this.levelUp();return!0}levelUp(){this.stats.experience-=this.stats.experienceToNext,this.stats.level++,this.stats.maxEnergy+=10,this.stats.energy=this.stats.maxEnergy,this.stats.experienceToNext=Math.floor(100*Math.pow(1.2,this.stats.level-1)),this.addReputation(10),this.onLevelUp()}onLevelUp(){console.log(`Player reached level ${this.stats.level}!`)}addReputation(e){this.stats.reputation=Math.max(0,this.stats.reputation+e)}addMoney(e){this.stats.money=Math.max(0,this.stats.money+e)}spendMoney(e){return this.stats.money>=e&&(this.stats.money-=e,!0)}consumeEnergy(e){return this.stats.energy>=e&&(this.stats.energy-=e,!0)}restoreEnergy(e){this.stats.energy=Math.min(this.stats.maxEnergy,this.stats.energy+e)}getSkills(){return{...this.skills}}getSkillLevel(e){return this.skills[e]}upgradeSkill(e,t=0){return!(t>0&&this.stats.reputation<t)&&(!(this.skills[e]>=10)&&(this.skills[e]++,t>0&&(this.stats.reputation-=t),this.onSkillUpgrade(e),!0))}onSkillUpgrade(e){console.log(`${e} upgraded to level ${this.skills[e]}!`),this.checkSkillUnlocks(e)}checkSkillUnlocks(e){const t=this.skills[e];switch(e){case"technicalMapping":t>=3&&this.unlockedContent.add("advanced-mapping-tools"),t>=5&&this.unlockedContent.add("shader-programming"),t>=8&&this.unlockedContent.add("custom-effects");break;case"artisticVision":t>=3&&this.unlockedContent.add("color-theory-lessons"),t>=5&&this.unlockedContent.add("advanced-compositions"),t>=8&&this.unlockedContent.add("signature-style");break;case"equipmentMastery":t>=3&&this.unlockedContent.add("projector-shop"),t>=5&&this.unlockedContent.add("high-end-equipment"),t>=8&&this.unlockedContent.add("custom-rigs");break;case"socialMedia":t>=3&&this.unlockedContent.add("streaming-platform"),t>=5&&this.unlockedContent.add("brand-partnerships"),t>=8&&this.unlockedContent.add("viral-marketing");break;case"collaboration":t>=3&&this.unlockedContent.add("team-projects"),t>=5&&this.unlockedContent.add("festival-invites"),t>=8&&this.unlockedContent.add("mentorship")}}getEquipment(){return{...this.equipment}}equipItem(e,t){if(this.hasInInventory(t)){const i=this.equipment[e];return i&&this.addToInventory(i,1),this.equipment[e]=t,this.removeFromInventory(t,1),this.onEquipmentChange(),!0}return!1}unequipItem(e){const t=this.equipment[e];return!!t&&(this.equipment[e]=null,this.addToInventory(t,1),this.onEquipmentChange(),!0)}addSoftware(e){this.equipment.software.includes(e)||(this.equipment.software.push(e),this.onEquipmentChange())}addAccessory(e){this.equipment.accessories.includes(e)||(this.equipment.accessories.push(e),this.onEquipmentChange())}onEquipmentChange(){console.log("Equipment changed")}getInventory(){return new Map(this.inventory)}addToInventory(e,t=1){const i=this.inventory.get(e)||0;this.inventory.set(e,i+t)}removeFromInventory(e,t=1){const i=this.inventory.get(e)||0;return i>=t&&(i===t?this.inventory.delete(e):this.inventory.set(e,i-t),!0)}hasInInventory(e,t=1){return(this.inventory.get(e)||0)>=t}getInventoryCount(e){return this.inventory.get(e)||0}getPosition(){return{...this.position}}setPosition(e,t,i){this.position.x=e,this.position.y=t,i&&(this.position.scene=i)}moveBy(e,t){this.position.x+=e,this.position.y+=t}getAchievements(){return new Set(this.achievements)}unlockAchievement(e){return!this.achievements.has(e)&&(this.achievements.add(e),this.onAchievementUnlocked(e),!0)}hasAchievement(e){return this.achievements.has(e)}onAchievementUnlocked(e){console.log(`Achievement unlocked: ${e}`),this.addExperience(50)}getUnlockedContent(){return new Set(this.unlockedContent)}hasUnlockedContent(e){return this.unlockedContent.has(e)}unlockContent(e){this.unlockedContent.add(e)}getEffectiveStats(){const e=this.getStats(),t=this.calculateEquipmentBonuses();return{...e,bonuses:t,maxEnergy:e.maxEnergy+(t.energy||0)}}calculateEquipmentBonuses(){const e={};return this.equipment.projector&&(e.artisticVision=1),"high-end-workstation"===this.equipment.computer&&(e.technicalMapping=2,e.energy=20),e}serialize(){return JSON.stringify({stats:this.stats,skills:this.skills,equipment:this.equipment,position:this.position,inventory:Array.from(this.inventory.entries()),achievements:Array.from(this.achievements),unlockedContent:Array.from(this.unlockedContent)})}deserialize(e){try{const t=JSON.parse(e);this.stats=t.stats||this.stats,this.skills=t.skills||this.skills,this.equipment=t.equipment||this.equipment,this.position=t.position||this.position,this.inventory=new Map(t.inventory||[]),this.achievements=new Set(t.achievements||[]),this.unlockedContent=new Set(t.unlockedContent||[])}catch(t){console.error("Failed to deserialize player data:",t)}}}class A{static instance;skillDefinitions=new Map;skillTree=[];constructor(){this.initializeSkillDefinitions(),this.initializeSkillTree()}static getInstance(){return A.instance||(A.instance=new A),A.instance}initializeSkillDefinitions(){[{id:"technicalMapping",name:"Technical Mapping",description:"Master the technical aspects of VJ mapping and projection",icon:"ðŸ”§",maxLevel:10,baseCost:20,costMultiplier:1.5,unlocks:[{level:2,content:["basic-mapping-tutorial"],description:"Unlock basic mapping tutorial"},{level:3,content:["advanced-mapping-tools"],description:"Access to advanced mapping software"},{level:5,content:["shader-programming","custom-effects"],description:"Learn shader programming and create custom effects"},{level:7,content:["realtime-mapping"],description:"Master real-time mapping techniques"},{level:10,content:["mapping-master-title"],description:"Become a recognized mapping master"}]},{id:"artisticVision",name:"Artistic Vision",description:"Develop your creative eye and artistic sensibility",icon:"ðŸŽ¨",maxLevel:10,baseCost:15,costMultiplier:1.4,unlocks:[{level:2,content:["color-theory-basics"],description:"Learn color theory fundamentals"},{level:3,content:["composition-techniques"],description:"Advanced composition techniques"},{level:5,content:["visual-storytelling","mood-creation"],description:"Master visual storytelling and mood creation"},{level:7,content:["signature-style"],description:"Develop your unique artistic signature"},{level:10,content:["artistic-recognition"],description:"Gain recognition as a visual artist"}]},{id:"equipmentMastery",name:"Equipment Mastery",description:"Learn to use and optimize VJ equipment",icon:"ðŸ“¹",maxLevel:10,baseCost:25,costMultiplier:1.6,unlocks:[{level:2,content:["projector-basics"],description:"Understanding projector fundamentals"},{level:3,content:["equipment-shop-access"],description:"Access to equipment marketplace"},{level:5,content:["high-end-equipment","equipment-modding"],description:"Unlock high-end equipment and modification options"},{level:7,content:["custom-rigs","multi-projector-setups"],description:"Build custom rigs and multi-projector setups"},{level:10,content:["equipment-expert-title"],description:"Become a recognized equipment expert"}]},{id:"socialMedia",name:"Social Media",description:"Build your online presence and audience",icon:"ðŸ“±",maxLevel:10,baseCost:10,costMultiplier:1.3,prerequisites:[{skill:"artisticVision",level:2}],unlocks:[{level:2,content:["social-media-tutorial"],description:"Learn social media best practices"},{level:3,content:["streaming-platform"],description:"Access to live streaming features"},{level:5,content:["content-scheduling","audience-analytics"],description:"Advanced content management and analytics"},{level:7,content:["brand-partnerships"],description:"Unlock brand partnership opportunities"},{level:10,content:["influencer-status"],description:"Achieve influencer status"}]},{id:"collaboration",name:"Collaboration",description:"Work effectively with other artists and professionals",icon:"ðŸ¤",maxLevel:10,baseCost:18,costMultiplier:1.4,prerequisites:[{skill:"socialMedia",level:2}],unlocks:[{level:2,content:["networking-basics"],description:"Learn networking fundamentals"},{level:3,content:["team-projects"],description:"Participate in collaborative projects"},{level:5,content:["festival-connections","artist-collectives"],description:"Connect with festivals and artist collectives"},{level:7,content:["mentorship-program"],description:"Join mentorship programs"},{level:10,content:["community-leader-title"],description:"Become a recognized community leader"}]}].forEach(e=>{this.skillDefinitions.set(e.id,e)})}initializeSkillTree(){this.skillTree=[{skill:"technicalMapping",position:{x:0,y:0},connections:["artisticVision","equipmentMastery"]},{skill:"artisticVision",position:{x:-150,y:100},connections:["technicalMapping","socialMedia"]},{skill:"equipmentMastery",position:{x:150,y:100},connections:["technicalMapping"]},{skill:"socialMedia",position:{x:-150,y:200},connections:["artisticVision","collaboration"]},{skill:"collaboration",position:{x:0,y:300},connections:["socialMedia"]}]}getSkillDefinition(e){return this.skillDefinitions.get(e)}getAllSkillDefinitions(){return Array.from(this.skillDefinitions.values())}getSkillTree(){return[...this.skillTree]}canUpgradeSkill(e,t){const i=this.skillDefinitions.get(t);if(!i)return{canUpgrade:!1,reason:"Skill not found"};const s=e.getSkillLevel(t);if(s>=i.maxLevel)return{canUpgrade:!1,reason:"Maximum level reached"};if(i.prerequisites)for(const r of i.prerequisites){if(e.getSkillLevel(r.skill)<r.level){return{canUpgrade:!1,reason:`Requires ${this.skillDefinitions.get(r.skill)?.name||r.skill} level ${r.level}`}}}const n=this.getUpgradeCost(t,s);return e.getStats().reputation<n?{canUpgrade:!1,reason:`Requires ${n} reputation`}:{canUpgrade:!0}}getUpgradeCost(e,t){const i=this.skillDefinitions.get(e);return i?Math.floor(i.baseCost*Math.pow(i.costMultiplier,t)):0}upgradeSkill(e,t){if(!this.canUpgradeSkill(e,t).canUpgrade)return!1;const i=e.getSkillLevel(t),s=this.getUpgradeCost(t,i);return!!e.upgradeSkill(t,s)&&(this.onSkillUpgraded(e,t,i+1),!0)}onSkillUpgraded(e,t,i){const s=this.skillDefinitions.get(t);if(!s)return;const n=s.unlocks.find(e=>e.level===i);n&&(n.content.forEach(t=>{e.unlockContent(t)}),this.triggerUnlockNotification(s.name,i,n.description)),e.addExperience(10*i)}triggerUnlockNotification(e,t,i){console.log(`${e} Level ${t}: ${i}`)}getRecommendedSkills(e){const t=e.getSkills(),i=[],s=Object.values(t).reduce((e,t)=>e+t,0)/Object.keys(t).length;return Object.entries(t).forEach(([t,n])=>{const r=t;this.canUpgradeSkill(e,r).canUpgrade&&n<=s+1&&i.push(r)}),i}getSkillSynergies(e){const t={},i=Math.min(e.technicalMapping,e.artisticVision);i>=3&&(t["Creative Technician"]=i);const s=Math.min(e.equipmentMastery,e.technicalMapping);s>=3&&(t["Technical Expert"]=s);const n=Math.min(e.socialMedia,e.collaboration);n>=3&&(t["Community Builder"]=n);const r=Math.min(...Object.values(e));r>=5&&(t["Jack of All Trades"]=r);const o=Math.max(...Object.values(e));return o>=8&&(t["Master Specialist"]=o),t}getSkillProgress(e){const t=e.getSkills(),i={};return Object.keys(t).forEach(e=>{const s=e,n=this.skillDefinitions.get(s);if(n){const e=t[s],r=n.maxLevel;i[s]={current:e,max:r,percentage:e/r*100}}}),i}checkSkillAchievements(e){const t=e.getSkills(),i=[];Object.entries(t).forEach(([t,s])=>{const n=t;[3,5,7,10].forEach(t=>{const r=`${n}_level_${t}`;s>=t&&!e.hasAchievement(r)&&(e.unlockAchievement(r),i.push(r))})});const s=this.getSkillSynergies(t);return Object.keys(s).forEach(t=>{const s=`synergy_${t.toLowerCase().replace(/\s+/g,"_")}`;e.hasAchievement(s)||(e.unlockAchievement(s),i.push(s))}),i}}class q{static instance;equipmentDatabase=new Map;upgradeDatabase=new Map;constructor(){this.initializeEquipmentDatabase(),this.initializeUpgradeDatabase()}static getInstance(){return q.instance||(q.instance=new q),q.instance}initializeEquipmentDatabase(){[{id:"basic-laptop",name:"Basic Laptop",description:"A simple laptop for getting started with VJ software",type:"computer",rarity:"common",cost:0,level:1,stats:{processing:1,memory:1,graphics:1},icon:"ðŸ’»"},{id:"gaming-laptop",name:"Gaming Laptop",description:"A powerful gaming laptop with dedicated graphics",type:"computer",rarity:"uncommon",cost:500,level:3,requirements:[{skill:"technicalMapping",level:2}],stats:{processing:3,memory:2,graphics:4},icon:"ðŸŽ®"},{id:"workstation",name:"Professional Workstation",description:"A high-end workstation built for professional VJ work",type:"computer",rarity:"rare",cost:2e3,level:6,requirements:[{skill:"technicalMapping",level:5},{skill:"equipmentMastery",level:4}],stats:{processing:6,memory:5,graphics:7},effects:["Multi-output support","Real-time effects"],icon:"ðŸ–¥ï¸"},{id:"custom-rig",name:"Custom VJ Rig",description:"A custom-built rig optimized for VJ performance",type:"computer",rarity:"epic",cost:5e3,level:8,requirements:[{skill:"technicalMapping",level:7},{skill:"equipmentMastery",level:7}],stats:{processing:9,memory:8,graphics:10},effects:["Multi-output support","Real-time effects","Advanced shader support"],icon:"âš¡"},{id:"basic-projector",name:"Basic Projector",description:"A simple home projector for practice",type:"projector",rarity:"common",cost:200,level:1,stats:{brightness:1,resolution:1,colorAccuracy:1},icon:"ðŸ“½ï¸"},{id:"venue-projector",name:"Venue Projector",description:"A mid-range projector suitable for small venues",type:"projector",rarity:"uncommon",cost:800,level:3,requirements:[{skill:"equipmentMastery",level:2}],stats:{brightness:3,resolution:3,colorAccuracy:2},icon:"ðŸŽ¬"},{id:"professional-projector",name:"Professional Projector",description:"A high-end projector for professional installations",type:"projector",rarity:"rare",cost:3e3,level:6,requirements:[{skill:"equipmentMastery",level:5}],stats:{brightness:6,resolution:6,colorAccuracy:5},effects:["Edge blending support","Advanced color correction"],icon:"ðŸŒŸ"},{id:"laser-projector",name:"Laser Projector",description:"State-of-the-art laser projector for premium installations",type:"projector",rarity:"legendary",cost:1e4,level:9,requirements:[{skill:"equipmentMastery",level:8},{skill:"technicalMapping",level:7}],stats:{brightness:10,resolution:9,colorAccuracy:10},effects:["Edge blending support","Advanced color correction","Instant on/off","Extended lifespan"],icon:"ðŸ”¥"},{id:"midi-controller",name:"MIDI Controller",description:"A basic MIDI controller for real-time control",type:"controller",rarity:"common",cost:150,level:2,requirements:[{skill:"technicalMapping",level:1}],stats:{responsiveness:2,features:1},icon:"ðŸŽ›ï¸"},{id:"vj-controller",name:"VJ Controller",description:"A specialized controller designed for VJ performance",type:"controller",rarity:"uncommon",cost:400,level:4,requirements:[{skill:"technicalMapping",level:3}],stats:{responsiveness:4,features:3},effects:["Crossfader support","Effect knobs"],icon:"ðŸŽšï¸"},{id:"professional-controller",name:"Professional VJ Controller",description:"A high-end controller with advanced features",type:"controller",rarity:"rare",cost:1200,level:7,requirements:[{skill:"technicalMapping",level:6},{skill:"equipmentMastery",level:5}],stats:{responsiveness:7,features:6},effects:["Crossfader support","Effect knobs","Touch strips","Custom mapping"],icon:"ðŸŽ¹"},{id:"basic-vj-software",name:"Basic VJ Software",description:"Free open-source VJ software for beginners",type:"software",rarity:"common",cost:0,level:1,stats:{features:1,stability:2},icon:"ðŸ“±"},{id:"intermediate-vj-software",name:"VJ Pro",description:"Commercial VJ software with more features",type:"software",rarity:"uncommon",cost:300,level:3,requirements:[{skill:"technicalMapping",level:2}],stats:{features:3,stability:3},effects:["Real-time effects","Multiple layers"],icon:"ðŸ’¿"},{id:"professional-vj-software",name:"VJ Master Suite",description:"Professional VJ software suite with advanced features",type:"software",rarity:"epic",cost:1500,level:6,requirements:[{skill:"technicalMapping",level:5}],stats:{features:7,stability:6},effects:["Real-time effects","Multiple layers","Advanced mapping","Plugin support"],icon:"ðŸ†"},{id:"capture-card",name:"Video Capture Card",description:"Capture external video sources",type:"accessory",rarity:"uncommon",cost:200,level:2,stats:{inputSources:2},effects:["External video input"],icon:"ðŸ“¹"},{id:"audio-interface",name:"Audio Interface",description:"Professional audio input/output interface",type:"accessory",rarity:"rare",cost:500,level:4,requirements:[{skill:"equipmentMastery",level:3}],stats:{audioQuality:5},effects:["High-quality audio","Multiple inputs"],icon:"ðŸŽµ"}].forEach(e=>{this.equipmentDatabase.set(e.id,e)})}initializeUpgradeDatabase(){this.upgradeDatabase.set("basic-laptop",[{id:"memory-upgrade",name:"Memory Upgrade",description:"Upgrade RAM for better performance",cost:100,statBoosts:{memory:1}},{id:"graphics-upgrade",name:"Graphics Card Upgrade",description:"Add a dedicated graphics card",cost:300,requirements:[{skill:"technicalMapping",level:3}],statBoosts:{graphics:2}}]),this.upgradeDatabase.set("venue-projector",[{id:"lens-upgrade",name:"Premium Lens",description:"High-quality lens for better image clarity",cost:200,requirements:[{skill:"equipmentMastery",level:3}],statBoosts:{resolution:1,colorAccuracy:1}},{id:"lamp-upgrade",name:"High-Brightness Lamp",description:"Brighter lamp for better visibility",cost:150,statBoosts:{brightness:2}}])}getEquipmentItem(e){return this.equipmentDatabase.get(e)}getAllEquipment(){return Array.from(this.equipmentDatabase.values())}getEquipmentByType(e){return this.getAllEquipment().filter(t=>t.type===e)}getAvailableEquipment(e){const t=e.getSkills(),i=e.getStats();return this.getAllEquipment().filter(e=>{if(e.level>i.level)return!1;if(e.requirements)for(const i of e.requirements)if(t[i.skill]<i.level)return!1;return!0})}canAffordEquipment(e,t){const i=this.getEquipmentItem(t);if(!i)return!1;return e.getStats().reputation>=i.cost}purchaseEquipment(e,t){const i=this.getEquipmentItem(t);return!!i&&(e.getStats(),!!this.canAffordEquipment(e,t)&&(!!this.getAvailableEquipment(e).some(e=>e.id===t)&&(e.addReputation(-i.cost),e.addToInventory(t,1),!0)))}getUpgrades(e){return this.upgradeDatabase.get(e)||[]}canUpgradeEquipment(e,t,i){const s=this.getUpgrades(t).find(e=>e.id===i);if(!s)return!1;const n=e.getSkills();if(e.getStats().reputation<s.cost)return!1;if(s.requirements)for(const r of s.requirements)if(n[r.skill]<r.level)return!1;return!!e.hasInInventory(t)}upgradeEquipment(e,t,i){if(!this.canUpgradeEquipment(e,t,i))return!1;const s=this.getUpgrades(t).find(e=>e.id===i);if(!s)return!1;e.addReputation(-s.cost);const n=`${t}_${i}`;return e.removeFromInventory(t,1),e.addToInventory(n,1),!0}compareEquipment(e,t){const i=this.getEquipmentItem(e),s=this.getEquipmentItem(t);if(!i||!s)return{};const n={};return new Set([...Object.keys(i.stats),...Object.keys(s.stats)]).forEach(e=>{const t=i.stats[e]||0,r=s.stats[e]||0;n[e]=t-r}),n}getRecommendedEquipment(e){const t=this.getAvailableEquipment(e),i=e.getEquipment(),s=e.getSkills();return t.filter(e=>{const t=i[e.type];if(t&&"string"==typeof t){const i=this.getEquipmentItem(t);if(i&&i.level>=e.level)return!1}return!0}).sort((e,t)=>{let i=0,n=0;return e.requirements&&(i+=e.requirements.reduce((e,t)=>e+s[t.skill],0)),t.requirements&&(n+=t.requirements.reduce((e,t)=>e+s[t.skill],0)),n-i}).slice(0,5)}calculateEquipmentBonuses(e){const t=e.getEquipment(),i={};return Object.entries(t).forEach(([e,t])=>{if("string"==typeof t){const e=this.getEquipmentItem(t);e&&Object.entries(e.stats).forEach(([e,t])=>{i[e]=(i[e]||0)+t})}}),t.software&&t.software.forEach(e=>{const t=this.getEquipmentItem(e);t&&Object.entries(t.stats).forEach(([e,t])=>{i[e]=(i[e]||0)+t})}),t.accessories&&t.accessories.forEach(e=>{const t=this.getEquipmentItem(e);t&&Object.entries(t.stats).forEach(([e,t])=>{i[e]=(i[e]||0)+t})}),i}getEquipmentSynergies(e){const t=e.getEquipment(),i=[],s="workstation"===t.computer||"custom-rig"===t.computer,n="professional-projector"===t.projector||"laser-projector"===t.projector,r=null!==t.controller;s&&n&&r&&i.push("Professional Setup");return"basic-laptop"===t.computer&&"basic-projector"===t.projector&&i.push("Getting Started"),i}getMarketPrices(){const e={};return this.getAllEquipment().forEach(t=>{const i=.8+.4*Math.random(),s=Math.floor(t.cost*i);let n="stable";i<.9?n="down":i>1.1&&(n="up"),e[t.id]={current:s,trend:n}}),e}}class E{static instance;achievements=new Map;playerProgress=new Map;constructor(){this.initializeAchievements()}static getInstance(){return E.instance||(E.instance=new E),E.instance}initializeAchievements(){[{id:"first_steps",name:"First Steps",description:"Reach level 2 in any skill",icon:"ðŸ‘¶",rarity:"common",category:"skill",points:10,requirements:[{type:"custom",value:1,description:"Reach level 2 in any skill",customCheck:e=>{const t=e.getSkills();return Object.values(t).some(e=>e>=2)}}],rewards:[{type:"experience",value:50}]},{id:"technical_mapping_novice",name:"Mapping Novice",description:"Reach Technical Mapping level 3",icon:"ðŸ”§",rarity:"common",category:"skill",points:15,requirements:[{type:"skill_level",skill:"technicalMapping",value:3,description:"Technical Mapping level 3"}],rewards:[{type:"experience",value:75},{type:"unlock",unlockId:"mapping_tutorial_advanced"}]},{id:"technical_mapping_expert",name:"Mapping Expert",description:"Reach Technical Mapping level 7",icon:"âš™ï¸",rarity:"rare",category:"skill",points:50,requirements:[{type:"skill_level",skill:"technicalMapping",value:7,description:"Technical Mapping level 7"}],rewards:[{type:"experience",value:200},{type:"reputation",value:100},{type:"unlock",unlockId:"expert_mapping_tools"}]},{id:"technical_mapping_master",name:"Mapping Master",description:"Reach Technical Mapping level 10",icon:"ðŸ†",rarity:"legendary",category:"skill",points:100,requirements:[{type:"skill_level",skill:"technicalMapping",value:10,description:"Technical Mapping level 10"}],rewards:[{type:"experience",value:500},{type:"reputation",value:300},{type:"unlock",unlockId:"mapping_master_title"}]},{id:"artistic_vision_novice",name:"Creative Eye",description:"Reach Artistic Vision level 3",icon:"ðŸŽ¨",rarity:"common",category:"skill",points:15,requirements:[{type:"skill_level",skill:"artisticVision",value:3,description:"Artistic Vision level 3"}],rewards:[{type:"experience",value:75}]},{id:"artistic_vision_master",name:"Visionary Artist",description:"Reach Artistic Vision level 10",icon:"ðŸŒŸ",rarity:"legendary",category:"skill",points:100,requirements:[{type:"skill_level",skill:"artisticVision",value:10,description:"Artistic Vision level 10"}],rewards:[{type:"experience",value:500},{type:"reputation",value:300}]},{id:"equipment_mastery_expert",name:"Gear Head",description:"Reach Equipment Mastery level 7",icon:"ðŸ› ï¸",rarity:"rare",category:"skill",points:50,requirements:[{type:"skill_level",skill:"equipmentMastery",value:7,description:"Equipment Mastery level 7"}],rewards:[{type:"experience",value:200},{type:"reputation",value:100}]},{id:"social_media_influencer",name:"Social Media Influencer",description:"Reach Social Media level 8",icon:"ðŸ“±",rarity:"epic",category:"social",points:75,requirements:[{type:"skill_level",skill:"socialMedia",value:8,description:"Social Media level 8"}],rewards:[{type:"experience",value:300},{type:"reputation",value:200},{type:"unlock",unlockId:"influencer_perks"}]},{id:"collaboration_master",name:"Team Player",description:"Reach Collaboration level 10",icon:"ðŸ¤",rarity:"legendary",category:"social",points:100,requirements:[{type:"skill_level",skill:"collaboration",value:10,description:"Collaboration level 10"}],rewards:[{type:"experience",value:500},{type:"reputation",value:300}]},{id:"well_rounded",name:"Well Rounded",description:"Reach level 5 in all skills",icon:"â­",rarity:"epic",category:"skill",points:75,requirements:[{type:"custom",value:5,description:"All skills at level 5",customCheck:e=>{const t=e.getSkills();return Object.values(t).every(e=>e>=5)}}],rewards:[{type:"experience",value:300},{type:"reputation",value:150},{type:"unlock",unlockId:"balanced_bonus"}]},{id:"perfectionist",name:"Perfectionist",description:"Reach level 10 in all skills",icon:"ðŸ’Ž",rarity:"legendary",category:"skill",points:200,requirements:[{type:"custom",value:10,description:"All skills at level 10",customCheck:e=>{const t=e.getSkills();return Object.values(t).every(e=>e>=10)}}],rewards:[{type:"experience",value:1e3},{type:"reputation",value:500},{type:"unlock",unlockId:"master_vj_title"}]},{id:"first_upgrade",name:"First Upgrade",description:"Purchase your first equipment upgrade",icon:"ðŸ“¦",rarity:"common",category:"equipment",points:10,requirements:[{type:"custom",value:1,description:"Own any non-starter equipment",customCheck:e=>{const t=e.getInventory(),i=e.getEquipment();return Array.from(t.keys()).some(e=>"basic-laptop"!==e&&"basic-vj-software"!==e)||Object.values(i).some(e=>e&&"basic-laptop"!==e&&"basic-vj-software"!==e)}}],rewards:[{type:"experience",value:25}]},{id:"gear_collector",name:"Gear Collector",description:"Own 10 different pieces of equipment",icon:"ðŸŽ›ï¸",rarity:"uncommon",category:"equipment",points:25,requirements:[{type:"custom",value:10,description:"Own 10 different equipment items",customCheck:e=>e.getInventory().size>=10}],rewards:[{type:"experience",value:100},{type:"reputation",value:50}]},{id:"high_end_setup",name:"High-End Setup",description:"Own a professional projector and workstation",icon:"ðŸ’»",rarity:"rare",category:"equipment",points:40,requirements:[{type:"custom",value:1,description:"Own professional projector and workstation",customCheck:e=>{const t=e.getInventory(),i=e.getEquipment(),s=t.has("professional-projector")||t.has("laser-projector")||"professional-projector"===i.projector||"laser-projector"===i.projector,n=t.has("workstation")||t.has("custom-rig")||"workstation"===i.computer||"custom-rig"===i.computer;return s&&n}}],rewards:[{type:"experience",value:200},{type:"reputation",value:100}]},{id:"level_10",name:"Rising Star",description:"Reach player level 10",icon:"â­",rarity:"uncommon",category:"milestone",points:20,requirements:[{type:"custom",value:10,description:"Player level 10",customCheck:e=>e.getStats().level>=10}],rewards:[{type:"experience",value:100},{type:"reputation",value:50}]},{id:"level_25",name:"Experienced VJ",description:"Reach player level 25",icon:"ðŸŒŸ",rarity:"rare",category:"milestone",points:50,requirements:[{type:"custom",value:25,description:"Player level 25",customCheck:e=>e.getStats().level>=25}],rewards:[{type:"experience",value:250},{type:"reputation",value:150}]},{id:"reputation_1000",name:"Well Known",description:"Earn 1000 reputation",icon:"ðŸ‘‘",rarity:"uncommon",category:"social",points:25,requirements:[{type:"reputation",value:1e3,description:"1000 reputation"}],rewards:[{type:"experience",value:150}]},{id:"reputation_5000",name:"Famous VJ",description:"Earn 5000 reputation",icon:"ðŸ†",rarity:"epic",category:"social",points:75,requirements:[{type:"reputation",value:5e3,description:"5000 reputation"}],rewards:[{type:"experience",value:400},{type:"unlock",unlockId:"vip_access"}]},{id:"secret_combo",name:"Secret Combo",description:"Discover a hidden feature",icon:"ðŸ”’",rarity:"rare",category:"secret",points:30,hidden:!0,requirements:[{type:"custom",value:1,description:"Perform secret combination",customCheck:()=>!1}],rewards:[{type:"experience",value:100},{type:"unlock",unlockId:"secret_feature"}]},{id:"red_rocks_performer",name:"Red Rocks Performer",description:"Perform at the legendary Red Rocks Amphitheatre",icon:"ðŸ”ï¸",rarity:"epic",category:"milestone",points:100,requirements:[{type:"custom",value:1,description:"Complete Red Rocks Level 4",customCheck:e=>e.hasUnlockedContent("red_rocks_completed")}],rewards:[{type:"experience",value:500},{type:"reputation",value:300},{type:"unlock",unlockId:"red_rocks_performer_title"}]},{id:"red_rocks_legend",name:"Red Rocks Legend",description:"Achieve a perfect 90+ rating at Red Rocks Amphitheatre",icon:"â­",rarity:"legendary",category:"milestone",points:200,requirements:[{type:"custom",value:1,description:"Score 90+ at Red Rocks",customCheck:e=>e.hasUnlockedContent("red_rocks_legend_rating")}],rewards:[{type:"experience",value:1e3},{type:"reputation",value:500},{type:"unlock",unlockId:"red_rocks_legend_status"},{type:"unlock",unlockId:"legendary_vj_title"}]},{id:"visual_virtuoso",name:"Visual Virtuoso",description:"Master the art of visual performance with flawless execution",icon:"ðŸŽ¨",rarity:"legendary",category:"skill",points:150,requirements:[{type:"custom",value:1,description:"Perfect visual performance",customCheck:e=>e.hasUnlockedContent("visual_virtuoso_performance")}],rewards:[{type:"experience",value:750},{type:"reputation",value:400},{type:"unlock",unlockId:"virtuoso_effects_pack"}]},{id:"lightbrush_master",name:"Lightbrush Master",description:"Complete the ultimate VJ journey and become a true master",icon:"ðŸ†",rarity:"legendary",category:"milestone",points:250,requirements:[{type:"custom",value:1,description:"Complete the VJ Career RPG",customCheck:e=>e.hasUnlockedContent("game_completed")}],rewards:[{type:"experience",value:1500},{type:"reputation",value:750},{type:"unlock",unlockId:"master_vj_certification"},{type:"unlock",unlockId:"post_game_content"}]},{id:"red_rocks_star",name:"Red Rocks Star",description:"Earn a 75+ rating at Red Rocks with great crowd reaction",icon:"ðŸŒŸ",rarity:"rare",category:"social",points:75,requirements:[{type:"custom",value:1,description:"Score 75+ at Red Rocks",customCheck:e=>e.hasUnlockedContent("red_rocks_star_rating")}],rewards:[{type:"experience",value:400},{type:"reputation",value:250},{type:"unlock",unlockId:"star_performer_perks"}]},{id:"crowd_favorite",name:"Crowd Favorite",description:"Get the crowd to their feet with outstanding energy",icon:"ðŸ‘",rarity:"rare",category:"social",points:60,requirements:[{type:"custom",value:1,description:"Achieve high crowd energy",customCheck:e=>e.hasUnlockedContent("crowd_favorite_energy")}],rewards:[{type:"experience",value:300},{type:"reputation",value:200},{type:"unlock",unlockId:"crowd_interaction_tools"}]},{id:"technical_master",name:"Technical Master",description:"Handle equipment malfunctions with professional expertise",icon:"âš™ï¸",rarity:"rare",category:"skill",points:80,requirements:[{type:"custom",value:1,description:"Successfully manage technical crises",customCheck:e=>e.hasUnlockedContent("technical_crisis_master")}],rewards:[{type:"experience",value:350},{type:"reputation",value:175},{type:"unlock",unlockId:"advanced_troubleshooting"}]},{id:"pyrotechnic_vj",name:"Pyrotechnic VJ",description:"Master the combination of fireworks and laser shows",icon:"ðŸŽ†",rarity:"epic",category:"skill",points:90,requirements:[{type:"custom",value:1,description:"Execute perfect fireworks and laser finale",customCheck:e=>e.hasUnlockedContent("pyrotechnic_finale_master")}],rewards:[{type:"experience",value:450},{type:"reputation",value:275},{type:"unlock",unlockId:"pyrotechnic_effects_suite"}]},{id:"colorado_native",name:"Colorado Native",description:"Feel at home performing in the beautiful Colorado landscape",icon:"ðŸ”ï¸",rarity:"uncommon",category:"milestone",points:40,requirements:[{type:"custom",value:1,description:"Appreciate the Red Rocks environment",customCheck:e=>e.hasUnlockedContent("colorado_appreciation")}],rewards:[{type:"experience",value:200},{type:"reputation",value:100},{type:"unlock",unlockId:"colorado_themed_effects"}]},{id:"amphitheater_architect",name:"Amphitheater Architect",description:"Understand and master the unique acoustics and visuals of Red Rocks",icon:"ðŸ›ï¸",rarity:"rare",category:"skill",points:70,requirements:[{type:"custom",value:1,description:"Master amphitheater performance dynamics",customCheck:e=>e.hasUnlockedContent("amphitheater_mastery")}],rewards:[{type:"experience",value:325},{type:"reputation",value:200},{type:"unlock",unlockId:"architectural_lighting_tools"}]},{id:"led_wall_specialist",name:"LED Wall Specialist",description:"Master the massive LED display systems at Red Rocks",icon:"ðŸ“º",rarity:"rare",category:"equipment",points:65,requirements:[{type:"custom",value:1,description:"Excel with professional LED wall systems",customCheck:e=>e.hasUnlockedContent("led_wall_mastery")}],rewards:[{type:"experience",value:300},{type:"reputation",value:150},{type:"unlock",unlockId:"advanced_led_controls"}]},{id:"beat_sync_master",name:"Beat Sync Master",description:"Perfect synchronization with music and crowd energy",icon:"ðŸŽµ",rarity:"epic",category:"skill",points:85,requirements:[{type:"custom",value:1,description:"Achieve perfect beat synchronization",customCheck:e=>e.hasUnlockedContent("beat_sync_perfection")}],rewards:[{type:"experience",value:400},{type:"reputation",value:225},{type:"unlock",unlockId:"rhythm_visualization_tools"}]},{id:"standing_ovation",name:"Standing Ovation",description:"Receive a standing ovation from the entire Red Rocks crowd",icon:"ðŸ‘",rarity:"epic",category:"social",points:120,requirements:[{type:"custom",value:1,description:"Earn standing ovation from full crowd",customCheck:e=>e.hasUnlockedContent("standing_ovation_achieved")}],rewards:[{type:"experience",value:600},{type:"reputation",value:350},{type:"unlock",unlockId:"ovation_memories"}]},{id:"phone_light_symphony",name:"Phone Light Symphony",description:"Create a magical moment with thousands of phone flashlights",icon:"ðŸ“±",rarity:"rare",category:"social",points:55,requirements:[{type:"custom",value:1,description:"Activate crowd phone lights en masse",customCheck:e=>e.hasUnlockedContent("phone_light_symphony")}],rewards:[{type:"experience",value:275},{type:"reputation",value:175},{type:"unlock",unlockId:"crowd_interaction_mastery"}]},{id:"equipment_crisis_manager",name:"Equipment Crisis Manager",description:"Successfully handle multiple equipment failures during the show",icon:"ðŸš¨",rarity:"rare",category:"skill",points:70,requirements:[{type:"custom",value:1,description:"Manage multiple equipment crises",customCheck:e=>e.hasUnlockedContent("crisis_management_expert")}],rewards:[{type:"experience",value:350},{type:"reputation",value:200},{type:"unlock",unlockId:"emergency_protocols"}]},{id:"finale_creator",name:"Finale Creator",description:"Craft an unforgettable finale experience",icon:"ðŸŽ­",rarity:"epic",category:"skill",points:95,requirements:[{type:"custom",value:1,description:"Create spectacular finale sequence",customCheck:e=>e.hasUnlockedContent("finale_creator_mastery")}],rewards:[{type:"experience",value:500},{type:"reputation",value:300},{type:"unlock",unlockId:"finale_composition_tools"}]},{id:"professional_review_excellence",name:"Professional Review Excellence",description:"Receive perfect 10/10 ratings from industry professionals",icon:"â­",rarity:"legendary",category:"milestone",points:180,requirements:[{type:"custom",value:1,description:"Achieve perfect professional ratings",customCheck:e=>e.hasUnlockedContent("perfect_professional_rating")}],rewards:[{type:"experience",value:800},{type:"reputation",value:500},{type:"unlock",unlockId:"industry_recognition"}]},{id:"red_rocks_hall_of_fame",name:"Red Rocks Hall of Fame",description:"Join the legendary performers who have graced Red Rocks",icon:"ðŸ›ï¸",rarity:"legendary",category:"milestone",points:300,hidden:!0,requirements:[{type:"custom",value:1,description:"Achieve legendary status at Red Rocks",customCheck:e=>e.hasAchievement("red_rocks_legend")&&e.hasAchievement("standing_ovation")&&e.hasAchievement("professional_review_excellence")&&e.getStats().reputation>=1e4}],rewards:[{type:"experience",value:2e3},{type:"reputation",value:1e3},{type:"unlock",unlockId:"hall_of_fame_status"},{type:"unlock",unlockId:"eternal_recognition"}]}].forEach(e=>{this.achievements.set(e.id,e)})}getAchievement(e){return this.achievements.get(e)}getAllAchievements(){return Array.from(this.achievements.values())}getVisibleAchievements(){return this.getAllAchievements().filter(e=>!e.hidden)}getAchievementsByCategory(e){return this.getAllAchievements().filter(t=>t.category===e)}checkAchievements(e){const t=[];return this.achievements.forEach((i,s)=>{if(e.hasAchievement(s))return;let n=0,r=1,o=!0;for(const t of i.requirements){const i=this.checkRequirement(e,t);n+=i.progress,r+=i.maxProgress,i.completed||(o=!1)}this.playerProgress.set(s,{achievementId:s,progress:n,maxProgress:r,completed:o,unlockedAt:o?new Date:void 0}),o&&e.unlockAchievement(s)&&(t.push(s),this.grantAchievementRewards(e,i))}),t}checkRequirement(e,t){switch(t.type){case"skill_level":if(t.skill){const i=e.getSkillLevel(t.skill);return{progress:Math.min(i,t.value),maxProgress:t.value,completed:i>=t.value}}break;case"total_experience":const i=e.getStats().experience;return{progress:Math.min(i,t.value),maxProgress:t.value,completed:i>=t.value};case"reputation":const s=e.getStats().reputation;return{progress:Math.min(s,t.value),maxProgress:t.value,completed:s>=t.value};case"equipment_owned":const n=e.getInventory(),r=Array.from(n.values()).reduce((e,t)=>e+t,0);return{progress:Math.min(r,t.value),maxProgress:t.value,completed:r>=t.value};case"custom":if(t.customCheck){const i=t.customCheck(e);return{progress:i?t.value:0,maxProgress:t.value,completed:i}}}return{progress:0,maxProgress:1,completed:!1}}grantAchievementRewards(e,t){t.rewards&&t.rewards.forEach(t=>{switch(t.type){case"experience":t.value&&e.addExperience(t.value);break;case"reputation":t.value&&e.addReputation(t.value);break;case"item":t.itemId&&e.addToInventory(t.itemId,1);break;case"unlock":t.unlockId&&e.unlockContent(t.unlockId)}})}getAchievementProgress(e){return this.playerProgress.get(e)}getAllProgress(){return Array.from(this.playerProgress.values())}getCompletedAchievements(){return this.getAllProgress().filter(e=>e.completed)}getInProgressAchievements(){return this.getAllProgress().filter(e=>!e.completed&&e.progress>0)}getAchievementStats(e){const t=this.achievements.size,i=e.getAchievements().size;return{total:t,unlocked:i,totalPoints:Array.from(this.achievements.values()).reduce((e,t)=>e+t.points,0),earnedPoints:Array.from(e.getAchievements()).map(e=>this.achievements.get(e)?.points||0).reduce((e,t)=>e+t,0),completionPercentage:i/t*100}}getRecentAchievements(e,t=5){return Array.from(e.getAchievements()).slice(-t).map(e=>this.achievements.get(e)).filter(e=>void 0!==e)}triggerSecretAchievement(e,t){const i=this.achievements.get(t);return!(!i||!i.hidden)&&(!!e.unlockAchievement(t)&&(this.grantAchievementRewards(e,i),!0))}getNearCompletionAchievements(e,t=.7){return Array.from(this.achievements.values()).filter(i=>{if(e.hasAchievement(i.id))return!1;const s=this.playerProgress.get(i.id);if(!s)return!1;return s.progress/s.maxProgress>=t}).sort((e,t)=>{const i=this.playerProgress.get(e.id),s=this.playerProgress.get(t.id),n=i?i.progress/i.maxProgress:0;return(s?s.progress/s.maxProgress:0)-n})}}w()(e((e,t)=>({player:new C,stats:{level:1,experience:0,experienceToNext:100,reputation:0,energy:100,maxEnergy:100,money:0},skills:{technicalMapping:1,artisticVision:1,equipmentMastery:1,socialMedia:1,collaboration:1},equipment:{projector:null,computer:"basic-laptop",controller:null,software:["basic-vj-software"],accessories:[]},position:{x:0,y:0,scene:"home"},inventory:new Map,achievements:new Set,unlockedContent:new Set,skillSystem:A.getInstance(),equipmentSystem:q.getInstance(),achievementSystem:E.getInstance(),autoSaveEnabled:!0,lastSaveTime:0,saveSlots:Array(5).fill(null),sessionStartTime:Date.now(),totalPlaytime:0,initializePlayer:()=>{const e=t(),i=localStorage.getItem("vj-game-autosave");if(i)try{e.player.deserialize(i)}catch(s){console.warn("Failed to load auto-save, starting fresh:",s)}t().refreshPlayerData(),t().startSession(),e.autoSaveEnabled&&setInterval(()=>{t().saveGame()},3e4)},refreshPlayerData:()=>{const{player:i}=t();e({stats:i.getStats(),skills:i.getSkills(),equipment:i.getEquipment(),position:i.getPosition(),inventory:i.getInventory(),achievements:i.getAchievements(),unlockedContent:i.getUnlockedContent()})},addExperience:e=>{const{player:i}=t(),s=i.addExperience(e);return t().refreshPlayerData(),t().checkAchievements(),s},addReputation:e=>{const{player:i}=t();i.addReputation(e),t().refreshPlayerData(),t().checkAchievements()},addMoney:e=>{const{player:i}=t();i.addMoney(e),t().refreshPlayerData(),t().checkAchievements()},spendMoney:e=>{const{player:i}=t(),s=i.spendMoney(e);return s&&t().refreshPlayerData(),s},consumeEnergy:e=>{const{player:i}=t(),s=i.consumeEnergy(e);return t().refreshPlayerData(),s},restoreEnergy:e=>{const{player:i}=t();i.restoreEnergy(e),t().refreshPlayerData()},upgradeSkill:e=>{const{skillSystem:i,player:s}=t(),n=i.upgradeSkill(s,e);return n&&(t().refreshPlayerData(),t().checkAchievements()),n},canUpgradeSkill:e=>{const{skillSystem:i,player:s}=t();return i.canUpgradeSkill(s,e)},getSkillProgress:()=>{const{skillSystem:e,player:i}=t();return e.getSkillProgress(i)},equipItem:(e,i)=>{const{player:s}=t(),n=s.equipItem(e,i);return n&&t().refreshPlayerData(),n},unequipItem:e=>{const{player:i}=t(),s=i.unequipItem(e);return s&&t().refreshPlayerData(),s},purchaseEquipment:e=>{const{equipmentSystem:i,player:s}=t(),n=i.purchaseEquipment(s,e);return n&&(t().refreshPlayerData(),t().checkAchievements()),n},getAvailableEquipment:()=>{const{equipmentSystem:e,player:i}=t();return e.getAvailableEquipment(i)},addToInventory:(e,i=1)=>{const{player:s}=t();s.addToInventory(e,i),t().refreshPlayerData(),t().checkAchievements()},removeFromInventory:(e,i=1)=>{const{player:s}=t(),n=s.removeFromInventory(e,i);return n&&t().refreshPlayerData(),n},hasInInventory:(e,i=1)=>{const{player:s}=t();return s.hasInInventory(e,i)},getInventoryCount:e=>{const{player:i}=t();return i.getInventoryCount(e)},setPosition:(e,i,s)=>{const{player:n}=t();n.setPosition(e,i,s),t().refreshPlayerData()},moveBy:(e,i)=>{const{player:s}=t();s.moveBy(e,i),t().refreshPlayerData()},checkAchievements:()=>{const{achievementSystem:e,player:i}=t(),s=e.checkAchievements(i);if(s.length>0){t().refreshPlayerData();const i=window.gameStore;i&&s.forEach(t=>{const s=e.getAchievement(t);s&&i.getState().addNotification({type:"achievement",title:"Achievement Unlocked!",message:`${s.name}: ${s.description}`,duration:8e3})})}return s},getAchievementStats:()=>{const{achievementSystem:e,player:i}=t();return e.getAchievementStats(i)},unlockContent:e=>{const{player:i}=t();i.unlockContent(e),t().refreshPlayerData()},hasUnlockedContent:e=>{const{player:i}=t();return i.hasUnlockedContent(e)},saveGame:async(i=0,s)=>{try{const{player:n,totalPlaytime:r}=t();t().updatePlaytime();const o={playerData:n.serialize(),timestamp:Date.now(),playerLevel:n.getStats().level,location:n.getPosition().scene,playtime:r,name:s||`Save ${i}`},a=0===i?"vj-game-autosave":`vj-game-save-${i}`;localStorage.setItem(a,JSON.stringify(o));const c=[...t().saveSlots];return c[i]={id:i,name:o.name,timestamp:o.timestamp,playerLevel:o.playerLevel,location:o.location,playtime:o.playtime},e({saveSlots:c,lastSaveTime:Date.now()}),!0}catch(n){return console.error("Failed to save game:",n),!1}},loadGame:async i=>{try{const s=0===i?"vj-game-autosave":`vj-game-save-${i}`,n=localStorage.getItem(s);if(!n)throw new Error("Save data not found");const r=JSON.parse(n),{player:o}=t();return o.deserialize(r.playerData),e({totalPlaytime:r.playtime||0,sessionStartTime:Date.now()}),t().refreshPlayerData(),!0}catch(s){return console.error("Failed to load game:",s),!1}},deleteSave:i=>{try{if(0===i)return!1;const s=`vj-game-save-${i}`;localStorage.removeItem(s);const n=[...t().saveSlots];return n[i]=null,e({saveSlots:n}),!0}catch(s){return console.error("Failed to delete save:",s),!1}},getSaveSlots:()=>{const e=[...t().saveSlots];for(let t=1;t<e.length;t++)try{const i=`vj-game-save-${t}`,s=localStorage.getItem(i);if(s){const i=JSON.parse(s);e[t]={id:t,name:i.name||`Save ${t}`,timestamp:i.timestamp,playerLevel:i.playerLevel,location:i.location,playtime:i.playtime||0}}}catch(i){console.warn(`Failed to load save slot ${t}:`,i)}return e},setAutoSave:t=>{e({autoSaveEnabled:t})},startSession:()=>{e({sessionStartTime:Date.now()})},updatePlaytime:()=>{const{sessionStartTime:i,totalPlaytime:s}=t(),n=Math.floor((Date.now()-i)/1e3);e({totalPlaytime:s+n,sessionStartTime:Date.now()})},getSessionDuration:()=>{const{sessionStartTime:e}=t();return Math.floor((Date.now()-e)/1e3)},resetPlayer:()=>{const i=new C;e({player:i,sessionStartTime:Date.now(),totalPlaytime:0}),t().refreshPlayerData()},exportPlayerData:()=>{const{player:e}=t();t().updatePlaytime();const i={playerData:e.serialize(),totalPlaytime:t().totalPlaytime,exportedAt:Date.now(),version:"1.0"};return JSON.stringify(i)},importPlayerData:i=>{try{const s=JSON.parse(i),{player:n}=t();return n.deserialize(s.playerData),e({totalPlaytime:s.totalPlaytime||0,sessionStartTime:Date.now()}),t().refreshPlayerData(),t().checkAchievements(),!0}catch(s){return console.error("Failed to import player data:",s),!1}}})));class P{gameEngine;currentScene=null;nextScene=null;isTransitioning=!1;transitionDuration=1;transitionTime=0;constructor(e){this.gameEngine=e}loadScene(e){this.isTransitioning?console.warn("Scene transition already in progress"):(this.nextScene=e,this.startTransition())}getCurrentScene(){return this.currentScene}startTransition(){this.isTransitioning=!0,this.transitionTime=0,this.currentScene&&this.currentScene.onExit()}completeTransition(){this.currentScene&&this.currentScene.destroy(),this.currentScene=this.nextScene,this.nextScene=null,this.currentScene&&this.currentScene.onEnter(),this.isTransitioning=!1,this.transitionTime=0}update(e){this.isTransitioning&&(this.transitionTime+=e,this.transitionTime>=this.transitionDuration&&this.completeTransition()),this.currentScene&&!this.isTransitioning&&this.currentScene.update(e)}render(e){this.isTransitioning?this.renderTransition(e):this.currentScene&&this.currentScene.render(e)}renderTransition(e){const t=Math.min(this.transitionTime/this.transitionDuration,1),i=Math.sin(t*Math.PI);this.currentScene&&(e.globalAlpha=1-.5*t,this.currentScene.render(e)),this.nextScene&&t>.5&&(e.globalAlpha=2*(t-.5),this.nextScene.render(e)),e.globalAlpha=1,this.renderTransitionOverlay(e,i)}renderTransitionOverlay(e,t){const i=e.canvas,s=i.width/2,n=i.height/2,r=e.createRadialGradient(s,n,0,s,n,Math.max(i.width,i.height));r.addColorStop(0,`rgba(0, 0, 0, ${.3*t})`),r.addColorStop(1,`rgba(0, 0, 0, ${.1*t})`),e.fillStyle=r,e.fillRect(0,0,i.width,i.height)}sceneStack=[];pushScene(e){this.currentScene&&(this.sceneStack.push(this.currentScene),this.currentScene.onPause()),this.currentScene=e,e.onEnter()}popScene(){this.currentScene&&(this.currentScene.onExit(),this.currentScene.destroy()),this.sceneStack.length>0?(this.currentScene=this.sceneStack.pop(),this.currentScene.onResume()):this.currentScene=null}isTransitionInProgress(){return this.isTransitioning}getTransitionProgress(){return this.isTransitioning?Math.min(this.transitionTime/this.transitionDuration,1):0}destroy(){this.currentScene&&this.currentScene.destroy(),this.nextScene&&this.nextScene.destroy(),this.sceneStack.forEach(e=>e.destroy()),this.sceneStack=[]}}class I{static instance;canvas;ctx;sceneManager;inputManager;audioManager;lastFrameTime=0;isRunning=!1;frameId=0;constructor(e){this.canvas=e,this.ctx=e.getContext("2d"),this.sceneManager=new P(this),this.inputManager=new b(e),this.audioManager=new j,this.setupCanvas()}static getInstance(e){return!I.instance&&e&&(I.instance=new I(e)),I.instance}setupCanvas(){const e=this.canvas.getBoundingClientRect(),t=window.devicePixelRatio||1;this.canvas.width=e.width*t,this.canvas.height=e.height*t,this.canvas.style.width=e.width+"px",this.canvas.style.height=e.height+"px",this.ctx.scale(t,t),window.addEventListener("resize",this.handleResize.bind(this))}handleResize(){this.setupCanvas()}start(){this.isRunning||(this.isRunning=!0,this.lastFrameTime=performance.now(),this.gameLoop())}stop(){this.isRunning=!1,this.frameId&&cancelAnimationFrame(this.frameId)}gameLoop(){if(!this.isRunning)return;const e=performance.now(),t=(e-this.lastFrameTime)/1e3;this.lastFrameTime=e,this.update(t),this.render(),this.frameId=requestAnimationFrame(()=>this.gameLoop())}update(e){this.inputManager.update(),this.sceneManager.update(e),this.audioManager.update()}render(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.sceneManager.render(this.ctx)}getSceneManager(){return this.sceneManager}getInputManager(){return this.inputManager}getAudioManager(){return this.audioManager}getCanvas(){return this.canvas}getContext(){return this.ctx}pause(){_.getState().setPaused(!0)}resume(){_.getState().setPaused(!1)}isPaused(){return _.getState().isPaused}destroy(){this.stop(),window.removeEventListener("resize",this.handleResize.bind(this)),this.inputManager.destroy(),this.audioManager.destroy(),I.instance=null}}const _=w()(e((e,t)=>({isInitialized:!1,isRunning:!1,isPaused:!1,currentScene:null,showHUD:!0,showMenu:!1,showInventory:!1,showSkillTree:!1,showAchievements:!1,showSettings:!1,currentDialog:null,notifications:[],loading:{isLoading:!1,loadingText:"",progress:0},vjCareerGame:{isActive:!1,player:null,scene:null},settings:{graphics:{quality:"medium",showParticles:!0,showAnimations:!0},audio:{masterVolume:.7,musicVolume:.5,sfxVolume:.8,muted:!1},controls:{keyboardControls:{moveUp:"KeyW",moveDown:"KeyS",moveLeft:"KeyA",moveRight:"KeyD",interact:"KeyE",menu:"Escape",inventory:"KeyI",skills:"KeyK"},mouseControls:!0,touchControls:!0},accessibility:{colorBlindMode:!1,highContrast:!1,reducedMotion:!1,textSize:"medium"}},initializeGame:async i=>{e({loading:{isLoading:!0,loadingText:"Initializing game engine...",progress:0}});try{const s=I.getInstance(i);e({loading:{isLoading:!0,loadingText:"Loading assets...",progress:25}});const n=s.getAudioManager();await n.preloadGameAudio(),e({loading:{isLoading:!0,loadingText:"Setting up game systems...",progress:50}}),t().loadSettings(),e({loading:{isLoading:!0,loadingText:"Finalizing...",progress:75}}),e({isInitialized:!0,loading:{isLoading:!0,loadingText:"Ready!",progress:100}}),setTimeout(()=>{e({loading:{isLoading:!1,loadingText:"",progress:0}})},500)}catch(s){console.error("Failed to initialize game:",s),e({loading:{isLoading:!1,loadingText:"",progress:0},notifications:[...t().notifications,{id:Date.now().toString(),type:"error",title:"Initialization Error",message:"Failed to initialize game engine",timestamp:Date.now()}]})}},startGame:()=>{const t=I.getInstance();t&&(t.start(),e({isRunning:!0,isPaused:!1}))},pauseGame:()=>{const t=I.getInstance();t&&(t.pause(),e({isPaused:!0}))},resumeGame:()=>{const t=I.getInstance();t&&(t.resume(),e({isPaused:!1}))},stopGame:()=>{const t=I.getInstance();t&&(t.stop(),e({isRunning:!1,isPaused:!1}))},setCurrentScene:t=>{e({currentScene:t})},toggleHUD:()=>e(e=>({showHUD:!e.showHUD})),showMenuModal:()=>{t().pauseGame(),e({showMenu:!0})},hideMenuModal:()=>{e({showMenu:!1}),t().resumeGame()},showInventoryModal:()=>e({showInventory:!0}),hideInventoryModal:()=>e({showInventory:!1}),showSkillTreeModal:()=>e({showSkillTree:!0}),hideSkillTreeModal:()=>e({showSkillTree:!1}),showAchievementsModal:()=>e({showAchievements:!0}),hideAchievementsModal:()=>e({showAchievements:!1}),showSettingsModal:()=>e({showSettings:!0}),hideSettingsModal:()=>e({showSettings:!1}),showDialog:(i,s,n)=>{t().pauseGame(),e({currentDialog:{character:i,text:s,options:n}})},hideDialog:()=>{e({currentDialog:null}),t().resumeGame()},addNotification:i=>{const s=Date.now().toString(),n=Date.now();if(e(e=>({notifications:[...e.notifications,{...i,id:s,timestamp:n}]})),0!==i.duration){const e=i.duration||5e3;setTimeout(()=>{t().removeNotification(s)},e)}},removeNotification:t=>{e(e=>({notifications:e.notifications.filter(e=>e.id!==t)}))},clearNotifications:()=>e({notifications:[]}),setLoading:(t,i="",s=0)=>{e({loading:{isLoading:t,loadingText:i,progress:Math.max(0,Math.min(100,s))}})},startNewGame:()=>{e({vjCareerGame:{isActive:!0,player:{level:1,experience:0,money:0,reputation:0},scene:{venue:null,isPerforming:!1}}})},addExperience:t=>{e(e=>{if(!e.vjCareerGame.player)return e;const i=e.vjCareerGame.player.experience+t,s=Math.floor(i/100)+1;return{vjCareerGame:{...e.vjCareerGame,player:{...e.vjCareerGame.player,experience:i,level:s}}}})},addMoney:t=>{e(e=>e.vjCareerGame.player?{vjCareerGame:{...e.vjCareerGame,player:{...e.vjCareerGame.player,money:e.vjCareerGame.player.money+t}}}:e)},setVenue:t=>{e(e=>({vjCareerGame:{...e.vjCareerGame,scene:e.vjCareerGame.scene?{...e.vjCareerGame.scene,venue:t}:{venue:t,isPerforming:!1}}}))},setPerforming:t=>{e(e=>({vjCareerGame:{...e.vjCareerGame,scene:e.vjCareerGame.scene?{...e.vjCareerGame.scene,isPerforming:t}:{venue:null,isPerforming:t}}}))},updateGraphicsSettings:i=>{e(e=>({settings:{...e.settings,graphics:{...e.settings.graphics,...i}}})),t().saveSettings()},updateAudioSettings:i=>{e(e=>({settings:{...e.settings,audio:{...e.settings.audio,...i}}}));const s=I.getInstance();if(s){const e=s.getAudioManager();void 0!==i.masterVolume&&e.setVolume("masterVolume",i.masterVolume),void 0!==i.musicVolume&&e.setVolume("musicVolume",i.musicVolume),void 0!==i.sfxVolume&&e.setVolume("sfxVolume",i.sfxVolume),void 0!==i.muted&&i.muted&&e.toggleMute()}t().saveSettings()},updateControlSettings:i=>{e(e=>({settings:{...e.settings,controls:{...e.settings.controls,...i}}})),t().saveSettings()},updateAccessibilitySettings:i=>{e(e=>({settings:{...e.settings,accessibility:{...e.settings.accessibility,...i}}})),t().saveSettings()},saveSettings:()=>{try{localStorage.setItem("vj-game-settings",JSON.stringify(t().settings))}catch(e){console.warn("Failed to save settings:",e)}},loadSettings:()=>{try{const t=localStorage.getItem("vj-game-settings");if(t){const i=JSON.parse(t);e(e=>({settings:{...e.settings,...i}}))}}catch(t){console.warn("Failed to load settings:",t)}}})));function T({scale:e=1,color:n="#8b5cf6",emissiveIntensity:a=.5}){const c=t.useRef(null),l=t.useRef(null),u=t.useMemo(()=>{const t=[];t.push([0,0,0]);for(let i=0;i<6;i++){const s=i/6*Math.PI*2;t.push([Math.cos(s)*e,Math.sin(s)*e,0])}for(let i=0;i<6;i++){const s=i/6*Math.PI*2+Math.PI/6;t.push([Math.cos(s)*e*1.7,Math.sin(s)*e*1.7,0])}return t},[e]),p=t.useMemo(()=>{const e=new r,t=[];for(let i=0;i<u.length;i++)for(let e=i+1;e<u.length;e++)t.push(u[i][0],u[i][1],u[i][2],u[e][0],u[e][1],u[e][2]);return e.setAttribute("position",new o(t,3)),e},[u]);return i(e=>{c.current&&(c.current.rotation.x=.1*e.clock.elapsedTime,c.current.rotation.y=.15*e.clock.elapsedTime,c.current.rotation.z=.05*e.clock.elapsedTime),l.current&&(l.current.rotation.z=.1*-e.clock.elapsedTime)}),s.jsxs("group",{ref:c,children:[u.map((t,i)=>s.jsxs("mesh",{position:t,children:[s.jsx("sphereGeometry",{args:[.1*e,32,32]}),s.jsx("meshPhysicalMaterial",{color:n,metalness:1,roughness:0,emissive:n,emissiveIntensity:a})]},i)),s.jsx("group",{ref:l,children:s.jsx("lineSegments",{geometry:p,children:s.jsx("lineBasicMaterial",{color:n,transparent:!0,opacity:.3,linewidth:1})})})]})}function R({scale:e=1,color:n="#ec4899"}){const r=t.useRef(null),o=t.useMemo(()=>{const t=[];t.push([0,0,0]);for(let i=0;i<6;i++){const s=i/6*Math.PI*2;t.push([Math.cos(s)*e,Math.sin(s)*e,0])}for(let i=0;i<6;i++){const s=i/6*Math.PI*2+Math.PI/6;t.push([Math.cos(s)*e*1.73,Math.sin(s)*e*1.73,0])}return t},[e]);return i(e=>{r.current&&(r.current.rotation.z=.1*e.clock.elapsedTime,r.current.scale.x=1+.1*Math.sin(e.clock.elapsedTime),r.current.scale.y=1+.1*Math.sin(e.clock.elapsedTime))}),s.jsx("group",{ref:r,children:o.map((t,i)=>s.jsxs("mesh",{position:t,children:[s.jsx("torusGeometry",{args:[.5*e,.02,8,64]}),s.jsx("meshPhysicalMaterial",{color:n,metalness:1,roughness:0,emissive:n,emissiveIntensity:.3,transparent:!0,opacity:.8})]},i))})}function D({scale:e=1,color:r="#10b981"}){const o=t.useRef(null),a=t.useRef(null);return i(e=>{o.current&&(o.current.rotation.y=.3*e.clock.elapsedTime),a.current&&(a.current.rotation.y=.5*-e.clock.elapsedTime,a.current.rotation.x=.2*e.clock.elapsedTime)}),s.jsxs("group",{ref:o,scale:e,children:[s.jsxs("mesh",{children:[s.jsx("tetrahedronGeometry",{args:[2,0]}),s.jsx("meshPhysicalMaterial",{color:r,metalness:.9,roughness:.1,transparent:!0,opacity:.7,emissive:r,emissiveIntensity:.3,side:n})]}),s.jsxs("mesh",{ref:a,rotation:[Math.PI,0,0],children:[s.jsx("tetrahedronGeometry",{args:[2,0]}),s.jsx("meshPhysicalMaterial",{color:r,metalness:.9,roughness:.1,transparent:!0,opacity:.7,emissive:r,emissiveIntensity:.3,side:n})]})]})}function L({scale:e=1}){const n=t.useRef(null);return i(e=>{n.current&&(n.current.rotation.x=.1*Math.sin(.1*e.clock.elapsedTime),n.current.rotation.y=.05*e.clock.elapsedTime)}),s.jsxs("group",{ref:n,scale:e,children:[s.jsx(T,{scale:2,color:"#8b5cf6",emissiveIntensity:.5}),s.jsx(R,{scale:3,color:"#ec4899"}),s.jsx(D,{scale:.8,color:"#10b981"})]})}function V({position:e,name:n,difficulty:r,onSelect:o,isActive:u}){const p=t.useRef(null);i(t=>{p.current&&u&&(p.current.rotation.y=.5*t.clock.elapsedTime,p.current.position.y=e[1]+.1*Math.sin(2*t.clock.elapsedTime))});const d={"Basement Club":"#10b981","Warehouse Party":"#3b82f6","Music Festival":"#ec4899","Red Rocks":"#f59e0b","Madison Square Garden":"#8b5cf6"};return s.jsx(a,{speed:2,rotationIntensity:.3,floatIntensity:.5,children:s.jsxs("group",{position:e,children:[s.jsx(l,{ref:p,args:[2,3,.5],onClick:o,children:s.jsx("meshPhysicalMaterial",{color:d[n]||"#ffffff",metalness:.9,roughness:.1,emissive:d[n]||"#ffffff",emissiveIntensity:u?.5:.2})}),s.jsx(c,{position:[0,2,0],fontSize:.3,color:"white",anchorX:"center",children:n}),s.jsxs(c,{position:[0,1.5,0],fontSize:.2,color:"#ffff00",anchorX:"center",children:["Difficulty: ",r]})]})})}function U({equipment:e,position:t}){return s.jsx("group",{position:t,children:e.map((e,t)=>s.jsxs(a,{speed:1+.2*t,children:[s.jsx(l,{position:[1.5*(t-1),0,0],args:[.8,.8,.8],children:s.jsx("meshPhysicalMaterial",{color:"legendary"===e.rarity?"#ffd700":"epic"===e.rarity?"#8b5cf6":"#3b82f6",metalness:1,roughness:0,emissive:"legendary"===e.rarity?"#ffd700":"#8b5cf6",emissiveIntensity:.3})}),s.jsx(c,{position:[1.5*(t-1),-.6,0],fontSize:.15,color:"white",anchorX:"center",children:e.name})]},t))})}function z({position:e}){const{vjCareerGame:i,startNewGame:n,addExperience:r,addMoney:o,setVenue:p,setPerforming:d}=_(e=>({vjCareerGame:e.vjCareerGame,startNewGame:e.startNewGame,addExperience:e.addExperience,addMoney:e.addMoney,setVenue:e.setVenue,setPerforming:e.setPerforming})),{player:h,scene:m}=i,g=i.isActive,[y,v]=t.useState(null),[f,k]=t.useState(!1),[x,S]=t.useState(!1),w=[{name:"Basement Club",difficulty:1,reward:100,xp:50},{name:"Warehouse Party",difficulty:2,reward:250,xp:100},{name:"Music Festival",difficulty:3,reward:500,xp:200},{name:"Red Rocks",difficulty:4,reward:1e3,xp:400},{name:"Madison Square Garden",difficulty:5,reward:2500,xp:800}];return s.jsxs("group",{position:e,children:[s.jsx(a,{speed:.5,rotationIntensity:.3,floatIntensity:.5,children:s.jsx("group",{onClick:()=>{try{S(!0),n(),setTimeout(()=>S(!1),500)}catch(e){console.error("Error starting new game:",e),S(!1)}},scale:1.5,children:s.jsx(T,{scale:2,color:g?"#ffd700":"#8b5cf6",emissiveIntensity:g?.8:.3})})}),!g&&!x&&s.jsx(c,{position:[0,3,0],fontSize:.5,color:"#8b5cf6",anchorX:"center",children:"CLICK TO START VJ CAREER"}),x&&s.jsx(c,{position:[0,3,0],fontSize:.5,color:"#ffd700",anchorX:"center",children:"INITIALIZING CAREER..."}),g&&s.jsxs(s.Fragment,{children:[s.jsx(c,{position:[0,7,0],fontSize:.8,color:"#8b5cf6",anchorX:"center",children:"VJ CAREER RPG"}),s.jsxs("group",{position:[0,6,0],children:[s.jsxs(c,{fontSize:.3,color:"white",anchorX:"center",children:["Level ",h?.level||1," VJ â€¢ ",h?.experience||0," XP â€¢ $",h?.money||0]}),s.jsxs(c,{position:[0,-.5,0],fontSize:.25,color:"#10b981",anchorX:"center",children:["Reputation: ",h?.reputation||0," â€¢ Current Venue: ",m?.venue||"None"]})]}),s.jsxs("group",{position:[0,2,0],children:[s.jsx(c,{position:[0,2,0],fontSize:.4,color:"white",anchorX:"center",children:"SELECT VENUE"}),w.map((e,t)=>{const i=t/w.length*Math.PI*2;return s.jsx(V,{position:[5*Math.cos(i),0,5*Math.sin(i)],name:e.name,difficulty:e.difficulty,onSelect:()=>(e=>{try{v(e.name),p(e.name),k(!0),d(!0),setTimeout(()=>{try{o(e.reward),r(e.xp),v(null),k(!1),d(!1)}catch(t){console.error("Error completing venue performance:",t),v(null),k(!1),d(!1)}},3e3)}catch(t){console.error("Error selecting venue:",t)}})(e),isActive:y===e.name},e.name)})]}),s.jsxs("group",{position:[0,-3,0],children:[s.jsx(c,{position:[0,1,0],fontSize:.3,color:"yellow",anchorX:"center",children:"EQUIPMENT SHOP"}),s.jsx(U,{equipment:[{name:"Basic Projector",cost:100,power:10,rarity:"common"},{name:"Pro Projector",cost:500,power:25,rarity:"epic"},{name:"Laser System",cost:1500,power:50,rarity:"legendary"}],position:[0,0,0]})]}),f&&s.jsxs("group",{position:[0,-5,0],children:[s.jsx(l,{args:[4,1,.2],children:s.jsx("meshPhysicalMaterial",{color:"#ffd700",emissive:"#ffd700",emissiveIntensity:.5,metalness:1,roughness:0})}),s.jsx(c,{position:[0,0,.2],fontSize:.3,color:"black",anchorX:"center",children:"PERFORMING..."})]}),y&&s.jsxs(s.Fragment,{children:[s.jsxs(c,{position:[0,-7,0],fontSize:.5,color:"#10b981",anchorX:"center",children:["PERFORMING AT ",y.toUpperCase()]}),s.jsx(u,{count:100,scale:15,size:3,speed:2,color:"#10b981"})]})]})]})}function G(){return s.jsxs(s.Fragment,{children:[s.jsx("ambientLight",{intensity:.2}),s.jsx("spotLight",{position:[20,20,20],angle:.3,penumbra:1,intensity:2,castShadow:!0}),s.jsx("directionalLight",{position:[-10,10,5],intensity:.5,color:"#8b5cf6"}),s.jsx("pointLight",{position:[0,10,0],intensity:1,color:"#ec4899"}),s.jsx(h,{preset:"city"}),s.jsx(m,{radius:200,depth:100,count:8e3,factor:4,saturation:0,fade:!0,speed:1}),s.jsx(u,{count:200,scale:20,size:2,speed:.5,color:"#8b5cf6"}),s.jsxs(g,{pages:5,damping:.15,children:[s.jsxs(y,{children:[s.jsxs("group",{position:[0,0,0],children:[s.jsx(a,{speed:.5,rotationIntensity:.2,floatIntensity:1,children:s.jsx(L,{scale:1.5})}),s.jsx(a,{speed:1,rotationIntensity:.3,floatIntensity:.5,children:s.jsx("group",{position:[5,2,-3],children:s.jsx(D,{scale:.5,color:"#f59e0b"})})}),s.jsx(a,{speed:1.5,rotationIntensity:.4,floatIntensity:.7,children:s.jsx("group",{position:[-5,-2,-3],children:s.jsx(R,{scale:.8,color:"#3b82f6"})})}),[...Array(40)].map((e,t)=>{const i=t/40*Math.PI*2,n=6+3*Math.sin(.5*t),r=4*Math.sin(.3*t);return s.jsx(a,{speed:2+.1*t,floatIntensity:1,children:s.jsx(v,{position:[Math.cos(i)*n,r,Math.sin(i)*n],args:[.3+.2*Math.random(),32,32],children:s.jsx(f,{color:(new k).setHSL(t/40*.3+.5,1,.6),speed:2,distort:.4,radius:1,emissive:(new k).setHSL(t/40*.3+.5,1,.5),emissiveIntensity:.5,metalness:.8,roughness:.2})})},t)})]}),s.jsxs("group",{position:[0,-10,0],children:[s.jsx(c,{position:[0,4,0],fontSize:1,color:"white",anchorX:"center",children:"PORTFOLIO"}),[{color:"#ec4899",title:"Urban Projection",pos:[-6,0,0]},{color:"#3b82f6",title:"Festival Mapping",pos:[-2,0,0]},{color:"#f59e0b",title:"Museum Display",pos:[2,0,0]},{color:"#10b981",title:"Concert Visual",pos:[6,0,0]}].map((e,t)=>s.jsx(a,{speed:1+.2*t,rotationIntensity:.5,children:s.jsxs("group",{position:e.pos,children:[s.jsx(l,{args:[2.5,3.5,.3],children:s.jsx("meshPhysicalMaterial",{color:e.color,metalness:.9,roughness:.1,clearcoat:1,emissive:e.color,emissiveIntensity:.3})}),s.jsx(c,{position:[0,0,.2],fontSize:.3,color:"white",anchorX:"center",children:e.title})]})},t))]}),s.jsx(z,{position:[0,-20,0]}),s.jsx("group",{position:[0,-30,0],children:[...Array(150)].map((e,t)=>s.jsx(a,{speed:3*Math.random(),floatIntensity:2*Math.random(),children:s.jsxs("mesh",{position:[20*(Math.random()-.5),20*(Math.random()-.5),20*(Math.random()-.5)],children:[s.jsx("icosahedronGeometry",{args:[.2+.3*Math.random(),0]}),s.jsx("meshPhysicalMaterial",{color:(new k).setHSL(Math.random(),1,.6),metalness:1,roughness:0,emissive:(new k).setHSL(Math.random(),1,.5),emissiveIntensity:.5})]})},t))}),s.jsx("group",{position:[0,-40,0],children:s.jsxs(a,{speed:1,rotationIntensity:.5,children:[s.jsx(l,{args:[5,2.5,.5],children:s.jsx("meshPhysicalMaterial",{color:"#ec4899",metalness:.95,roughness:.05,emissive:"#ec4899",emissiveIntensity:.4})}),s.jsx(c,{position:[0,0,.3],fontSize:.6,color:"white",anchorX:"center",children:"START A PROJECT"})]})})]}),s.jsxs(y,{html:!0,style:{width:"100%",pointerEvents:"none"},children:[s.jsx("div",{style:{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsxs(M.div,{initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},transition:{duration:1.5,ease:"easeOut"},style:{textAlign:"center"},children:[s.jsx("h1",{style:{fontSize:"clamp(4rem, 10vw, 10rem)",fontWeight:900,background:"linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #feca57 75%, #667eea 100%)",backgroundSize:"200% 200%",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",animation:"gradient 5s ease infinite",marginBottom:"1rem",textShadow:"0 0 80px rgba(139, 92, 246, 0.5)"},children:"LIGHTBRUSH"}),s.jsx("p",{style:{fontSize:"clamp(1rem, 3vw, 2rem)",color:"rgba(255,255,255,0.9)",fontWeight:300,letterSpacing:"0.2em"},children:"IMMERSIVE 3D EXPERIENCES"})]})}),s.jsx("div",{style:{height:"100vh"}}),s.jsx("div",{style:{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsxs("div",{style:{textAlign:"center",pointerEvents:"auto"},children:[s.jsx("h2",{style:{color:"#8b5cf6",fontSize:"4rem",textShadow:"0 0 30px rgba(139, 92, 246, 0.8)",animation:"pulse 2s infinite"},children:"ðŸŽ® VJ CAREER RPG"}),s.jsx("p",{style:{color:"white",fontSize:"1.5rem",marginBottom:"1rem"},children:"Start your journey as a projection mapping VJ!"}),s.jsx("p",{style:{color:"#8b5cf6",fontSize:"1.2rem"},children:"Click the purple crystal to begin your career"}),s.jsxs("div",{style:{marginTop:"2rem",padding:"1rem",background:"rgba(139, 92, 246, 0.1)",borderRadius:"10px",border:"2px solid #8b5cf6"},children:[s.jsx("p",{style:{color:"white",fontSize:"1rem",marginBottom:"0.5rem"},children:"ðŸ›ï¸ Perform at legendary venues from basement clubs to Madison Square Garden"}),s.jsx("p",{style:{color:"white",fontSize:"1rem",marginBottom:"0.5rem"},children:"ðŸŽ¨ Purchase and upgrade projection equipment"}),s.jsx("p",{style:{color:"white",fontSize:"1rem"},children:"â­ Build your reputation in the VJ community"})]})]})}),s.jsx("div",{style:{height:"100vh"}}),s.jsx("div",{style:{height:"100vh"}})]})]}),s.jsx(x,{position:[0,-5,0],opacity:.5,scale:40,blur:2,color:"#8b5cf6"})]})}function F(){return s.jsxs(s.Fragment,{children:[s.jsx("style",{children:"\n        @keyframes gradient {\n          0% { background-position: 0% 50%; }\n          50% { background-position: 100% 50%; }\n          100% { background-position: 0% 50%; }\n        }\n        @keyframes pulse {\n          0%, 100% { transform: scale(1); }\n          50% { transform: scale(1.05); }\n        }\n        body {\n          margin: 0;\n          padding: 0;\n          overflow: hidden;\n        }\n        * {\n          cursor: crosshair;\n        }\n      "}),s.jsxs("div",{style:{width:"100vw",height:"100vh",background:"radial-gradient(ellipse at center, #1a0033 0%, #000000 100%)",position:"fixed",top:0,left:0},children:[s.jsx(p,{shadows:!0,dpr:[1,2],camera:{position:[0,2,10],fov:50},children:s.jsx(t.Suspense,{fallback:null,children:s.jsx(G,{})})}),s.jsx(d,{containerStyles:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},barStyles:{background:"linear-gradient(90deg, #f093fb 0%, #f5576c 100%)"},dataStyles:{color:"white",fontSize:"1.2rem"}})]})]})}S.createRoot(document.getElementById("root")).render(s.jsx(t.StrictMode,{children:s.jsx(F,{})}));
//# sourceMappingURL=index-Bx5gDVp5.js.map
